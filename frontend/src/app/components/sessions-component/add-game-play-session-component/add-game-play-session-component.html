<section class="rounded-lg border-2 border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 bg-white
my-6 px-6 shadow-md w-10/12  mx-auto navBar:w-full">

  @if(!expanded) {
    <div class="cursor-pointer flex py-4 justify-center" (click)="onExpandChange()">
      <img ngSrc="assets/PlusSign.png" alt="Plus Sign Icon" width="40" height="40">
      <h3 class="text-2xl font-bold  text-brand4 pt-1">Log a Game Play Session</h3>
    </div>
  }

  @if(expanded) {
    <div class="flex flex-col">

      <div class="cursor-pointer flex py-4 justify-center" (click)="onExpandChange()">
        <img ngSrc="assets/MinusSign.png" alt="Minus Sign Icon" width="40" height="40">
        <h3 class="text-2xl font-bold  pt-1 text-brand4">Log a Game Play Session</h3>
      </div>

      <form autocomplete="off" #gameForm="ngForm" (ngSubmit)="triggerSubmit(gameForm)">

        <div class="p-4 m-2 bg-gradient-to-br from-brand2 to-brand1 rounded-lg shadow-md">

        <div class="py-2 flex flex-col" id="gameSection">


          <section>

            <div class="flex flex-col mt-4">
              <input class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg"
                     type="text" placeholder="Enter Game Title" #searchGameBox id="gameSearchBox">
              <label class="pt-2 block text-sm font-medium text-gray-700" for="gameSearchBox">Game Title</label>
            </div>

            <div class="flex space-x-4">
              <button type="button" class=" bg-brand5 text-white font-semibold my-4 py-2 px-4 rounded-md hover:bg-brand4 focus:outline-none focus:ring-2 focus:ring-brand2 active:bg-brand3 w-full max-w-lg"
                      (click)="triggerGameLookup(searchGameBox.value)">Search for Game</button>

              <button type="button" class=" bg-brand5 text-white font-semibold my-4 py-2 px-4 rounded-md hover:bg-brand4 focus:outline-none focus:ring-2 focus:ring-brand2 active:bg-brand3 w-full max-w-lg"
                      (click)="triggerGameFilterClear()">Clear Search Filter</button>

            </div>
          </section>


          <section class="pb-6">



              @if(games.length > 0) {

                <table class="rounded-lg border-2 border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 px-6 shadow-md table-fixed space-y-4 w-full max-w-4xl mx-auto">

                  <colgroup>
                    <col class="w-auto">
                    <col class="w-[100px]">
                  </colgroup>

                  <thead class="bg-brand2">
                  <tr>
                    <th class="table-auto border-collapse border-2 border-brand4  px-4 py-2 text-white">Game Name</th>
                    <th class="table-auto border-collapse border-2 border-brand4 max-w-[100px]"></th>
                  </tr>
                  </thead>

                  <tbody class="bg-white">
                    @for(game of games; track game.gameId) {
                      <tr>
                        <td class="border-2 border-brand4 px-4  text-gray-700">{{ game.title }}</td>
                        <td class="border-2 border-brand4 px-4">
                          <div class="flex justify-center">
                          <img class="cursor-pointer" ngSrc="assets/PlusSign.png" alt="Plus Sign Icon" width="40" height="40"
                                 (click)="triggerAddGame(game.gameId, game.title)"  id={{game.gameId}}>
                          </div>
                        </td>
                      </tr>

                    }
                  </tbody>

                </table>

            }

          </section>

          <div class="navBar: flex space-x-4">
            @if(gameId > 0) {
              <p class="mt-2 navBar:mt-0 text-white text-xl">{{selectedGameName}}</p>
              <button type="button" class="navBar:max-w-sm bg-brand5 text-white font-semibold py-2 px-4 rounded-md hover:bg-brand4 focus:outline-none focus:ring-2 focus:ring-brand2 active:bg-brand3 w-full max-w-lg"
                      (click)="triggerGameRemove()">Deselect</button>
            }
          </div>

        </div>


          <div class="flex flex-col space-x-0 navBar:flex-row navBar:space-x-4">
            <div class="py-2 flex flex-col" id="sessionDateTimeSection">

              <input type="datetime-local" class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand3 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full "
                     [(ngModel)]="sessionDateTime" name="sessionDateTime" id="sessionDateTime">
              <label class="pt-2 block text-sm font-medium text-gray-700" for="sessionDateTime">Session Date / Time</label>

            </div>


            <div class="py-2 flex flex-col" id="scoringModelSection">

              <select class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand4 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full "
                      [(ngModel)]="scoringModel" name="scoringModel" id="scoringModel">
                <option value="RANKING">Ranking</option>
                <option value="TEAM">Teams</option>
                <option value="COOPERATIVE">Cooperative</option>
              </select>
              <label class="pt-2 block text-sm font-medium text-gray-700" for="scoringModel">Scoring Model</label>

            </div>
          </div>

        </div>

      <!-- @if(scoringModel===ScoringModelEnum.TEAM) {
        <div class="p-4 m-2 bg-gradient-to-br from-brand3 to-brand2 rounded-lg shadow-md" id="teamSection">

          <div class="flex flex-col">
            <input class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand3 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full"
                    [(ngModel)]="numberTeams" (ngModelChange)="onNumTeamChange()"  type="number" name="numberTeams" id="numberTeams" min="2" max="50">

            <label class="pt-2 block text-sm font-medium text-gray-700" for="numberTeams">Number of Teams</label>
          </div>
            @for(sessionTeam of sessionTeams; let i = $index; track i) {

              <div class="flex py-2 justify-start space-x-4">

                <div >
                  <input class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand3 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full"
                         [(ngModel)]="sessionTeam.teamName" type="text" [name]="'nameForTeam' + (i + 1)" [id]="'nameForTeam' + (i + 1)" placeholder="Enter Team Name">
                  <label class="pt-2 block text-sm font-medium text-gray-700" [for]="'nameForTeam' + i">{{  'Team ' + (i + 1) + ' Name:' }}</label>
                </div>

              <div class="flex flex-col">
              <input class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand4 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none max-w-lg text-center"
                     [(ngModel)]="sessionTeam.result"  type="number" [name]="'rankingForTeam' + (i + 1)" [id]="'rankingForTeam' + (i + 1)" min="1" [max]="numberTeams">
                <label class="pt-2 block text-sm font-medium text-gray-700" [for]="'rankingForTeam' + i">{{  'Team ' + (i + 1) + ' Place:' }}</label>
              </div>

              </div>
            }



        </div>

        } -->



          @if(scoringModel===ScoringModelEnum.COOPERATIVE) {
            <div class="p-4 m-2 bg-gradient-to-br from-brand3 to-brand2 rounded-lg shadow-md flex flex-col" id="cooperativeResultSection">

              <select class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand3 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg"
                      [(ngModel)]="cooperativeResult" name="cooperativeResult" id="cooperativeResult">
                <option value=1 selected="selected">We Won!</option>
                <option value=0>We Lost!</option>
              </select>

              <label class="pt-2 block text-sm font-medium text-gray-700" for="cooperativeResult">Group Result</label>
            </div>
          }





        <div class="p-4 m-2 bg-gradient-to-br from-brand4 to-brand3 rounded-lg shadow-md" id="playerLoopSection">

          <div class="py-2 flex flex-col" id="numberOfPlayersSection">

            <input class="p-2  h-10 border-2 rounded-md border-t-brand3 border-r-brand2 border-b-brand2 border-l-brand1 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg"
                   [(ngModel)]="numberPlayers" (ngModelChange)="onNumPlayerChange()" type="number" name="numberPlayers" id="numberPlayers" min="1" max="100">
            <label class="pt-2 block text-sm font-medium text-gray-700" for="numberPlayers">Number of Players</label>

          </div>

          <div>

          </div>


          @for(sessionParticipant of sessionParticipants; let i = $index; track i) {

            <div class="flex py-2 space-x-4" id="playerSelectSection">

              <div>



                <select class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg"
                        [(ngModel)]="sessionParticipant.playerId" [name]="'playerSelectionMenu' + i" [id]="'playerSelectionMenu' + i">
                  @for(member of network; track member.id) {
                    <option  [value]="member.id" [id]="'infoForPlayer' + (i + 1)">{{member.firstName + " " + member.lastName + " | " + member.identifier}}</option>
                  }

                </select>

                <label class="pt-2 block text-sm font-medium text-gray-700">{{  'Player ' + (i + 1) + ' Name' }}</label>

              </div>

              <div>

                @if(scoringModel===ScoringModelEnum.RANKING || scoringModel===ScoringModelEnum.TEAM) {

                  <input class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg text-center"
                         [(ngModel)]="sessionParticipant.result" type="number" [name]="'rankingForPlayer' + i" [id]="'rankingForPlayer' + i" min="1" [max]="numberPlayers">

                  <label class="pt-2 block text-sm font-medium text-gray-700" [for]="'rankingForPlayer' + i">{{  'Player ' + (i + 1) + ' Place' }}</label>

                }

                <!-- @if(scoringModel===ScoringModelEnum.TEAM) {
                  <div class="flex flex-col">
                    <select class="p-2  h-10 border-2 rounded-md border-t-brand5 border-r-brand4 border-b-brand3 border-l-brand2 text-gray-700  focus:border-brand4 focus:ring-2 focus:ring-brand1 focus:outline-none w-full max-w-lg"
                            [(ngModel)]="sessionParticipant.teamIndex" [name]="'teamAssociationMenu' + i" [id]="'teamAssociationMenu' + i">

                      @for(sessionTeam of sessionTeams; let i = $index; track i) {
                        <option   [value]=i>{{sessionTeam.teamName}}</option>
                      }
                    </select>

                    <label for="teamSelect" id="teamSelect">Select Team</label>
                  </div>
                } -->

              </div>

            </div>

            <div id="teamAssociationSection">



            </div>



            <div id="playerRankingSection">




            </div>

          }
        </div>

        <div class="flex justify-center">
          <button class=" bg-brand5 text-white font-semibold my-4 py-2 px-4 rounded-md hover:bg-brand4 focus:outline-none focus:ring-2 focus:ring-brand2 active:bg-brand3 w-full max-w-lg"
                  type="submit">Submit Game Play Session</button>
        </div>


      </form>
    </div>
  }


</section>






